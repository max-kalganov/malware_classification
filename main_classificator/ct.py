import time

############################################
#  PATHS
############################################

PATH_TO_MALWARE_DATASET_FOLDER = '/media/max/hdd_part/Downloads/kaggle/malware-classification/'
TEST_FOLDER = 'test/'
TRAIN_FOLDER = 'train/'
TEST_CUT_FOLDER = 'test_cut/'
TRAIN_CUT_FOLDER = 'train_cut/'
TEST_PREPROCESSED_FOLDER = 'test_preprocessed/'
TRAIN_PREPROCESSED_FOLDER = 'train_preprocessed/'
TRAIN_FULL_PREPROCESSED_FOLDER = 'train_full_preprocessed/'
PREPROCESSED_FILES_PREFIX = 'batch_'
PATH_TO_LABELS = "trainLabels.csv"
PREDICTIONS_FOLDER = "predictions/"
PREDICTION_PREFIX = "prediction_"


############################################
#  Data constants
############################################

ID_COLUMN = "Id"
CLASS_COLUMN = "Class"
BYTES_COLUMN = "Bytes"
PREDICTION_COLUMN = "Prediction"
PREDICTION1_COL = "Prediction1"
PREDICTION2_COL = "Prediction2"
PREDICTION3_COL = "Prediction3"
PREDICTION4_COL = "Prediction4"
PREDICTION5_COL = "Prediction5"
PREDICTION6_COL = "Prediction6"
PREDICTION7_COL = "Prediction7"
PREDICTION8_COL = "Prediction8"
PREDICTION9_COL = "Prediction9"

ALL_PREDICTION_COLUMNS = [
    PREDICTION1_COL,
    PREDICTION2_COL,
    PREDICTION3_COL,
    PREDICTION4_COL,
    PREDICTION5_COL,
    PREDICTION6_COL,
    PREDICTION7_COL,
    PREDICTION8_COL,
    PREDICTION9_COL
]

RESULT_COLUMNS = [ID_COLUMN] + ALL_PREDICTION_COLUMNS

label_columns = [
    ID_COLUMN,
    CLASS_COLUMN
]

SAMPLE_SIZE = 11
NUM_OF_TEST_BATCHES = 3625
MIN_LEN = 6500
OVERLAP = 1000


############################################
#  Extentions
############################################

ASM_EXT = '.asm'
BYTES_EXT = '.bytes'
CSV_EXT = '.csv'


############################################
#  Functions
############################################


def get_path_to_test_folder() -> str:
    return PATH_TO_MALWARE_DATASET_FOLDER + TEST_FOLDER


def get_path_to_test_cut_folder() -> str:
    return PATH_TO_MALWARE_DATASET_FOLDER + TEST_CUT_FOLDER


def get_path_to_train_folder() -> str:
    return PATH_TO_MALWARE_DATASET_FOLDER + TRAIN_FOLDER


def get_path_to_train_cut_folder() -> str:
    return PATH_TO_MALWARE_DATASET_FOLDER + TRAIN_CUT_FOLDER


def get_path_to_train_labels_csv() -> str:
    return PATH_TO_MALWARE_DATASET_FOLDER + PATH_TO_LABELS


def get_path_to_train_preprocessed_folder() -> str:
    return PATH_TO_MALWARE_DATASET_FOLDER + TRAIN_PREPROCESSED_FOLDER


def get_path_to_test_preprocessed_file(num_of_batch: int):
    return PATH_TO_MALWARE_DATASET_FOLDER + \
           TEST_PREPROCESSED_FOLDER + \
           PREPROCESSED_FILES_PREFIX + \
           str(num_of_batch) + \
           CSV_EXT


def get_path_to_train_preprocessed_file(num_of_batch: int):
    return PATH_TO_MALWARE_DATASET_FOLDER + \
           TRAIN_PREPROCESSED_FOLDER + \
           PREPROCESSED_FILES_PREFIX + \
           str(num_of_batch) + \
           CSV_EXT


def get_path_to_train_full_preprocessed_file(num_of_batch: int):
    return PATH_TO_MALWARE_DATASET_FOLDER + \
           TRAIN_FULL_PREPROCESSED_FOLDER + \
           PREPROCESSED_FILES_PREFIX + \
           str(num_of_batch) + \
           CSV_EXT


def get_predictions_new_file() -> str:
    return PATH_TO_MALWARE_DATASET_FOLDER + PREDICTIONS_FOLDER + PREDICTION_PREFIX + str(int(time.time())) + CSV_EXT
